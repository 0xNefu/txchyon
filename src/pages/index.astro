---
import { getCollection } from 'astro:content';
import Base from "@/layouts/Base.astro";
import Posts from "@/layouts/components/Posts.astro";
import Pagination from "@/layouts/components/Pagination.astro";

const allPosts = await getCollection('posts', ({ data }) => !data.draft);

// Sort by date, newest first
const sortedPosts = allPosts
  .sort((a, b) => new Date(b.data.date).getTime() - new Date(a.data.date).getTime());

// Show 7 latest posts
const currentPosts = sortedPosts.slice(0, 7);
const totalPages = Math.ceil(allPosts.length / 7); // Simple pagination
---

<Base>
  <section class="section">
    <div class="container">
      <Posts posts={currentPosts} className="mb-16" />
      <Pagination currentPage={1} totalPages={totalPages} />
    </div>
  </section>
</Base>